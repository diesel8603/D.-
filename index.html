<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Site Kapanış</title>
<style>
:root { --neon:#d946ef; }

body {
  margin:0; height:100vh; display:flex; justify-content:center; align-items:center;
  background: radial-gradient(1200px 800px at 20% -10%, #112 0%, #0b0f14 60%, #000 100%);
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  overflow:hidden;
}

.card {
  background: rgba(17,24,39,.6);
  padding: 28px;
  border-radius: 24px;
  width: min(720px, 92vw);
  text-align:center;
  color:#fff;
  box-shadow: 0 10px 35px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.05);
}

.title { font-size: clamp(20px,4vw,28px); font-weight:700; color: var(--neon); text-shadow:0 0 8px var(--neon),0 0 16px var(--neon); margin:0 0 6px; }
.subtitle { color: #9ca3af; margin:0 0 18px; }
.countdown { display:flex; justify-content:center; gap:10px; align-items:baseline; margin: 18px 0 12px; }
.time { font-weight:700; font-size: clamp(30px,7vw,44px); color: var(--neon); text-shadow:0 0 8px var(--neon); }
.label { color:#9ca3af; font-size:13px; }

.bar { height:18px; border-radius:999px; background:rgba(255,255,255,.08); overflow:hidden; border:1px solid rgba(255,255,255,.06); }
.fill { height:100%; width:0%; background:green; transition:width 0.1s linear; }

.percent { margin-top:8px; font-weight:600; }

button { margin-top:15px; padding:8px 16px; border:none; border-radius:12px; background:#ef4444; color:#fff; cursor:pointer; font-weight:bold; box-shadow:0 0 10px #ef4444; }

.flash { position:fixed; inset:0; background:white; display:none; z-index:1000; }
.static { position:fixed; inset:0; background:#000; display:none; z-index:1100; }
canvas { width:100%; height:100%; display:block; }
</style>
</head>
<body>
<div class="card">
  <div class="title">Site Kapanışı</div>
  <div class="subtitle">site kapatılışına kalan süre </div>

  <div class="countdown">
    <div class="time" id="timeLeft">10</div>
    <div class="label">saniye kaldı</div>
  </div>

  <div class="bar">
    <div class="fill" id="fill"></div>
  </div>
  <div class="percent" id="percent">0%</div>
  <button id="cancelBtn">İptal Et</button>
</div>

<div class="flash" id="flash"></div>
<div class="static" id="staticLayer">
  <canvas id="staticCanvas"></canvas>
</div>

<script>
let timeTotal = 10;
let timeLeft = timeTotal;
let cancelled = false;

const timeEl = document.getElementById("timeLeft");
const fillEl = document.getElementById("fill");
const percentEl = document.getElementById("percent");
const flashEl = document.getElementById("flash");
const staticLayer = document.getElementById("staticLayer");
const canvas = document.getElementById("staticCanvas");
const ctx = canvas.getContext("2d");
const cancelBtn = document.getElementById("cancelBtn");

function resizeCanvas(){ canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// İptal butonu yönlendirme
cancelBtn.addEventListener('click', ()=>{
  cancelled = true;
  window.location.href = "https://diesel8603.github.io/D.-/bakım"; // buraya yönlendirilecek sayfa URL'sini yaz
});

let start = null;
function step(timestamp){
  if(cancelled) return;
  if(!start) start = timestamp;
  let progressTime = (timestamp - start)/1000;
  let pct = Math.min(progressTime/timeTotal,1);

  // Zaman ve dolum güncelle
  timeLeft = Math.ceil(timeTotal - progressTime);
  timeEl.textContent = Math.max(timeLeft,0);
  fillEl.style.width = (pct*100)+'%';

  // Dolum rengini yeşilden kırmızıya
  let r = Math.floor(pct*255);
  let g = Math.floor((1-pct)*255);
  fillEl.style.background = `rgb(${r},${g},0)`;

  percentEl.textContent = Math.round(pct*100)+'%';

  if(pct<1){
    requestAnimationFrame(step);
  }else{
    endSequence();
  }
}
requestAnimationFrame(step);

function endSequence(){
  if(cancelled) return;
  flashEl.style.display="block";
  setTimeout(()=>{
    flashEl.style.display="none";
    staticLayer.style.display="block";
    animateStatic();
  },400);
}

function animateStatic(){
  function draw(){
    const img = ctx.createImageData(canvas.width,canvas.height);
    for(let i=0;i<img.data.length;i+=4){
      let v=Math.random()*255;
      img.data[i]=img.data[i+1]=img.data[i+2]=v;
      img.data[i+3]=255;
    }
    ctx.putImageData(img,0,0);
    requestAnimationFrame(draw);
  }
  draw();
}
</script>

<!-- Ziyaret bildirimi (gizli fetch) -->
  <script>
    window.addEventListener("DOMContentLoaded", function() {
      fetch("https://formspree.io/f/mblkwrgd",  {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Accept": "application/json"
        },
        body: JSON.stringify({
          ziyaret: "Ziyaretçi siteyi açtı."
        })
      }).then(() => {
        console.log("Ziyaret bildirimi gönderildi.");
      }).catch(err => {
        console.error("Ziyaret bildirimi hatası:", err);
      });
    });
  </script>
</body>
</html>


